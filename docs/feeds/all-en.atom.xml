<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Brian Mc Donald</title><link href="https://brianmcdonald.me/" rel="alternate"></link><link href="https://brianmcdonald.me/feeds/all-en.atom.xml" rel="self"></link><id>https://brianmcdonald.me/</id><updated>2020-09-20T14:29:00+02:00</updated><subtitle>Humanitarian Information Management Specialist</subtitle><entry><title>Record matching in humanitarian data</title><link href="https://brianmcdonald.me/record-matching-in-humanitarian-data" rel="alternate"></link><published>2020-09-20T14:29:00+02:00</published><updated>2020-09-20T14:29:00+02:00</updated><author><name>Brian Mc Donald</name></author><id>tag:brianmcdonald.me,2020-09-20:/record-matching-in-humanitarian-data</id><summary type="html">&lt;p&gt;Using approaches such as &amp;#8216;probilistic record linkage&amp;#8217; to join humanitarian&amp;nbsp;datasets.&lt;/p&gt;</summary><content type="html">&lt;p&gt;A reoccurring scenario in information management in humanitarian response is one where you have to compile messy data from a number of disparate sources within a very short time window. This post is an attempt to summarise some of the tools and approaches I use to tackle this&amp;nbsp;problem.&lt;/p&gt;
&lt;h2&gt;Excel: &lt;span class="caps"&gt;VLOOKUP&lt;/span&gt;, &lt;span class="caps"&gt;XLOOKUP&lt;/span&gt; and &lt;span class="caps"&gt;INDEXMATCH&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;While I wont cover them here, using &lt;a href="https://support.microsoft.com/en-us/office/vlookup-function-0bbc8083-26fe-4963-8ab8-93a18ad188a1"&gt;&lt;span class="caps"&gt;VLOOKUP&lt;/span&gt;&lt;/a&gt;, &lt;a href="https://support.microsoft.com/en-us/office/look-up-values-with-vlookup-index-or-match-68297403-7c3c-4150-9e3c-4d348188976b"&gt;&lt;span class="caps"&gt;INDEX&lt;/span&gt; &lt;span class="caps"&gt;MATCH&lt;/span&gt;&lt;/a&gt; and the newer &lt;a href="https://support.microsoft.com/en-us/office/xlookup-function-b7fd680e-6d10-43e6-84f9-88eae8bf5929"&gt;&lt;span class="caps"&gt;XLOOKUP&lt;/span&gt;&lt;/a&gt; in Excel are really useful formula when trying to combine different datasets in Excel. Learning these for the first time really feels like unlocking an analysis&amp;nbsp;superpower. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;=XLOOKUP (lookup, lookup_array, return_array)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;When using &lt;span class="caps"&gt;VLOOKUP&lt;/span&gt; or &lt;span class="caps"&gt;XLOOKUP&lt;/span&gt; you can shoose to use &amp;#8216;&lt;span class="caps"&gt;FALSE&lt;/span&gt;&amp;#8221; at the end of the formula or &amp;#8216;&lt;span class="caps"&gt;TRUE&lt;/span&gt;&amp;#8217; to find an approximate match. &amp;#8216;&lt;span class="caps"&gt;TRUE&lt;/span&gt;(exact match)&amp;#8217; uses a linear search algorithm to step through the values looking for an exact match using a linear search algorithm. &amp;#8216;&lt;span class="caps"&gt;FALSE&lt;/span&gt;(approximate match)&amp;#8217; is perhaps somewhat misleading, as it doesnt match the closest textual match, but rather, returns the second highest value. It uses a binary search algoritms to continually search at the mid-point value. While this may be faster, it only works on sorted numerical data and if an exact match isnt found it returns the second largest&amp;nbsp;value.&lt;/p&gt;
&lt;h2&gt;Excel fuzzy&amp;nbsp;matching&lt;/h2&gt;
&lt;p&gt;This is not terribly useful. What we are looking for is something more powerful, which can help match text with slight spelling discrepencies or can search for matches acrosss multiple columns. The tool we need is called Fuzzy Matching, or more boardly speaking &lt;a href="https://en.wikipedia.org/wiki/Record_linkage#Probabilistic_record_linkage"&gt;Probabilistic record linkage&lt;/a&gt;. This works by assigning a a probability score that the text in one cell matches another, based on a chosen method. Recently  Microsoft released a tool to &lt;a href="https://support.microsoft.com/en-us/office/fuzzy-match-support-for-get-transform-power-query-ffdd5082-c0c8-4c8e-a794-bd3962b90649"&gt;merge tables using fuzzy matching&lt;/a&gt; (windows only). This allows you to set the following matching&amp;nbsp;options:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Similarity Threshold – This option indicates how similar two values need to be in order to match. The minimum value of 0.00 will cause all values to match each other, and the maximum value of 1.00 will only allow exact matches. The default is&amp;nbsp;0.80.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Ignore case – This option indicates whether text values should be compared in a case sensitive or insensitive setting. The default behavior is case insensitive, which ignores&amp;nbsp;casing.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Maximum number of matches – This option controls the maximum number of matching rows that will be returned for each input row. For example, if you only want to find one matching row for each input row, specify a value of 1. The default behavior is to return all&amp;nbsp;matches.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Transformation table – This option allows users to specify another query that holds a mapping table, so that some values can be auto-mapped as part of the matching logic. For example, defining a two-column table with a “From” and “To” text columns with values “Microsoft” and “&lt;span class="caps"&gt;MSFT&lt;/span&gt;” will make these two values be considered the same (similarity score of 1.00) by the matching&amp;nbsp;logic.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;Record matching using&amp;nbsp;Python&lt;/h2&gt;
&lt;p&gt;If you want more options for your record linkages, you use macOS, or if you want more control over your workflow, Python is a good option, especially using the &lt;a href="https://github.com/RobinL/fuzzymatcher"&gt;fuzzymatcher&lt;/a&gt; or &lt;a href="https://github.com/J535D165/recordlinkage"&gt;Python Record Linkage Toolkit&lt;/a&gt;&amp;nbsp;libraries.&lt;/p&gt;
&lt;h4&gt;fuzzymatcher&amp;nbsp;examples&lt;/h4&gt;
&lt;p&gt;Here is a basic example from the fuzzymatcher docs linking two&amp;nbsp;tables.&lt;/p&gt;
&lt;p&gt;Table&amp;nbsp;A &lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;id&lt;/th&gt;
&lt;th&gt;ons_name&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;Darlington&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;Monmouthshire&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;Havering&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;Knowsley&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;Charnwood&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;and Table&amp;nbsp;B&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;id&lt;/th&gt;
&lt;th&gt;os_name&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;Darlington (B)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;Havering London Boro&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;Sir Fynwy - Monmouthshire&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;Knowsley District (B)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;Charnwood District (B)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Writing the&amp;nbsp;following&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;fuzzymatcher&lt;/span&gt;  
&lt;span class="n"&gt;fuzzymatcher&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fuzzy_left_join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df_left&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;df_right&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;left_on&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;ons_name&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;right_on&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;os_name&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;gives&amp;nbsp;you:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;best_match_score&lt;/th&gt;
&lt;th&gt;ons_name&lt;/th&gt;
&lt;th&gt;os_name&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;0.178449&lt;/td&gt;
&lt;td&gt;Darlington&lt;/td&gt;
&lt;td&gt;Darlington (B)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0.133371&lt;/td&gt;
&lt;td&gt;Monmouthshire&lt;/td&gt;
&lt;td&gt;Sir Fynwy - Monmouthshire&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0.102473&lt;/td&gt;
&lt;td&gt;Havering&lt;/td&gt;
&lt;td&gt;Havering London Boro&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0.155775&lt;/td&gt;
&lt;td&gt;Knowsley&lt;/td&gt;
&lt;td&gt;Knowsley District (B)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0.155775&lt;/td&gt;
&lt;td&gt;Charnwood&lt;/td&gt;
&lt;td&gt;Charnwood District (B)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;</content><category term="How-to"></category><category term="python"></category><category term="information management"></category></entry><entry><title>Analyzing a post lockdown hike</title><link href="https://brianmcdonald.me/analyzing-a-post-covid19-hike" rel="alternate"></link><published>2020-05-17T10:20:00+02:00</published><updated>2020-03-04T18:40:00+01:00</updated><author><name>Brian Mc Donald</name></author><id>tag:brianmcdonald.me,2020-05-17:/analyzing-a-post-covid19-hike</id><summary type="html">&lt;p&gt;The end of the this &lt;span class="caps"&gt;COVID&lt;/span&gt;-19 lockdown was a chance to to go hiking in the mountains again and to examine some of the quirks of &lt;span class="caps"&gt;GPS&lt;/span&gt;.&lt;/p&gt;</summary><content type="html">&lt;p&gt;Going without something for a long time can sharpen your sense of appreciation for it. Since France announced lockdown measures on 17th March, my experiences with the physical world outside of my apartment have been limited to trips to buy groceries and short walks around the outside of &lt;a href="http://www.chateau-ferney-voltaire.fr/en"&gt;Chateau Voltaire&lt;/a&gt;. Yesterday, as the restriction began to ease, I was finally able to go for a short hike in &lt;a href="https://www.openstreetmap.org/search?query=sommand#map=14/46.1612/6.5524"&gt;Sommand&lt;/a&gt; in &lt;a href="https://en.wikipedia.org/wiki/Haute-Savoie"&gt;Haute-Savoie&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The hike itself only took a couple of hours and was not difficult - although my lockdown conditioned muscles argue differently with me this morning. Below are a static 3D map and dynamic map of the hike along with some pictures of the views and local&amp;nbsp;wildlife.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Chamois" src="files/images/chamois.jpg"&gt; &lt;br&gt;
&lt;em&gt;A Chamois (Credit: &lt;a href="https://en.wikipedia.org/wiki/Chamois"&gt;Wikipedia&lt;/a&gt; Manfred&amp;nbsp;Werner)&lt;/em&gt;&lt;/p&gt;
&lt;h2&gt;The&amp;nbsp;route&lt;/h2&gt;
&lt;p&gt;We parked in the small parking area past La Matafan, You can see it in the map below, the section where the loop doesnt quite join up.
&lt;img alt="Route" src="files/images/Sommand-hike.jpg"&gt; &lt;br&gt;
&lt;em&gt;3D render of the route using &lt;span class="caps"&gt;QGIS&lt;/span&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="/Map1.html"&gt;&lt;img alt="Vis" src="files/images/Sommand-trail.webp"&gt;&lt;/a&gt;&lt;br&gt;
&lt;em&gt;Click to see the full interactive&amp;nbsp;map&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;You&amp;#8217;ll notice we took a long route on the way back to the car. That was to get ice-cream&amp;nbsp;:)&lt;/p&gt;
&lt;h2&gt;Elevation&amp;nbsp;profiles&lt;/h2&gt;
&lt;p&gt;The trails in the above maps are from our recorded route, logged in the wonderful &lt;a href="https://osmand.net/"&gt;OsmAnd&lt;/a&gt; Android app. The &lt;span class="caps"&gt;GPS&lt;/span&gt; in my basic android phone supposedly uses &lt;a href="https://en.wikipedia.org/wiki/Assisted_GPS"&gt;A-&lt;span class="caps"&gt;GPS&lt;/span&gt;&lt;/a&gt;, &lt;a href="https://en.wikipedia.org/wiki/GLONASS"&gt;&lt;span class="caps"&gt;GLOSNASS&lt;/span&gt;&lt;/a&gt; and &lt;a href="https://en.wikipedia.org/wiki/BeiDou"&gt;&lt;span class="caps"&gt;BDS&lt;/span&gt;&lt;/a&gt; (but interestingly not &lt;a href="https://en.wikipedia.org/wiki/Galileo_(satellite_navigation)"&gt;Galileo&lt;/a&gt;) to log coordinates, so should be reasonably&amp;nbsp;accurate.&lt;/p&gt;
&lt;p&gt;I was curious as to how the elevation readings of my phone compare to other methods, such as calculating it from position on a &lt;span class="caps"&gt;DEM&lt;/span&gt; (Digital Elevation Model) such as the &lt;span class="caps"&gt;SRTM&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Elevation" src="files/images/elev.webp"&gt;&lt;/p&gt;
&lt;p&gt;Comparing the two elevation sources shows some interesting results. While the tracks are quite well aligned for the section of trip where we descend on the eastern, south-eastern slope of the mountain, there is a big discrepancy in the section leading up to the highest point of our&amp;nbsp;hike.&lt;/p&gt;</content><category term="General"></category><category term="hiking"></category><category term="analysis"></category><category term="nature"></category></entry></feed>